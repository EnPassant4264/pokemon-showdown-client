{"version":3,"sources":["../src/battle-dex-search.ts"],"names":["DexSearch","searchType","formatid","species","query","dex","Dex","typedSearch","results","exactMatch","firstPokemonColumn","sortCol","filters","setType","window","room","curTeam","mod","getTypedSearch","format","speciesOrSet","BattlePokemonSearch","BattleItemSearch","BattleMoveSearch","BattleAbilitySearch","BattleTypeSearch","BattleCategorySearch","find","toID","getResults","textSearch","addFilter","entry","type","includes","filter","push","removeFilter","filterid","join","deleted","i","length","splice","pop","toggleSort","filterLabel","filterType","illegalLabel","id","illegalReasons","getTier","searchTypeIndex","typeTable","qFilterType","slice","charAt","toUpperCase","BattleTypeChart","getClosest","BattleSearchIndex","passType","searchPasses","queryAlias","BattleAliases","aliasPassType","unshift","substr","matchLength","matchQuery","bufs","topbufIndex","count","nearMatch","instafilter","instafilterSort","illegal","searchPass","shift","typeIndex","gen","startsWith","matchStart","matchEnd","originalIndex","BattleSearchIndexOffset","charCodeAt","table","BattleTeambuilderTable","BattlePokedex","exists","overrideDexInfo","BattleItems","overrideItemDesc","BattleMovedex","overrideMoveInfo","BattleAbilities","overrideAbilityDesc","replace","overrideTypeChart","typeName","curBufLength","topbuf","concat","Array","prototype","apply","fType","fId","buf","illegalBuf","pokedex","moveDex","types","abilities","category","basePower","getSpecies","ability","getAbility","name","hasAbility","left","right","mid","Math","floor","pokemon","tier","move","item","egggroup","article","BattleTypedSearch","modFormat","set","formatType","baseResults","baseIllegalResults","sortRow","ClientMods","ModConfig","Number","overrideFormat","modFormatType","modid","formats","formatTable","teambuilderFormat","forGen","endsWith","getDefaultResults","call","getBaseResults","legalityFilter","resultType","value","getTable","illegalResults","result","rowType","sort","firstLearnsetid","speciesid","learnsets","baseLearnsetid","baseSpecies","battleOnly","nextLearnsetid","learnsetid","lsetSpecies","next","changesFrom","prevo","canLearn","moveid","getMove","isNonstandard","genChar","learnset","overrideLearnsets","num","String","modFormatTable","gameType","doubles","tableKey","overrideTier","requireNoCache","pathSpec","require","cache","resolve","metagameHeaders","MetagameHeaders","requirePentagon","isDoublesOrBS","tierSet","tiers","map","r","slices","formatSlices","Uber","Regular","OU","UU","RU","NU","PU","ZU","LC","AG","DUber","DOU","DUU","DNU","zuBans","banned","customTierSet","customTiers","bans","unbans","unbanned","headerCount","lastHeader","emptyHeaders","test","row","eggGroups","rowType1","id1","rowType2","id2","pokedex1","pokedex2","baseStats","stat1","stat2","base1","base2","bst1","hp","atk","def","spa","spd","spe","bst2","name1","name2","Error","fullAbilityName","isHackmons","isAAA","abilitySet","isMega","goodAbilities","poorAbilities","badAbilities","abil","rating","fullItemName","itemSet","items","speciesName","speciesSpecific","getItem","itemUser","moveIsNotUseless","abilityid","itemid","moves","weightkg","evos","GOOD_DOUBLES_MOVES","moveData","GOOD_STATUS_MOVES","GOOD_WEAK_MOVES","flags","charge","recharge","BAD_STRONG_MOVES","isSTABmons","galarBornLegality","sketchMoves","sketch","JSON","parse","stringify","learnsetEntry","nonstandardMoves","isMax","isZ","prevoSpecies","excludedForme","s","forme","otherFormes","formeName","usableMoves","uselessMoves","isUsable","powerTable","frustration","spitup","trumpcard","naturalgift","grassknot","lowkick","gyroball","electroball","flail","reversal","present","wringout","crushgrip","heatcrash","heavyslam","fling","magnitude","beatup","punishment","psywave","nightshade","seismictoss","dragonrage","sonicboom","superfang","endeavor","sheercold","fissure","horndrill","guillotine","move1","move2","pow1","pow2","modAcc1","overrideAcc","modAcc2","accuracy1","accuracy","accuracy2","modPP1","overridePP","modPP2","pp1","pp","pp2","physical","special","status"],"mappings":"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WADj5B,CAC85B,UAD95B,CAC06B,UAD16B,CACs7B,OADt7B,CAC+7B,aAD/7B,CAC88B,OAD98B,CACu9B,aADv9B,CACs+B,WADt+B,CACm/B,OADn/B,CAC4/B,WAD5/B,CACygC,WADzgC,CACshC,MADthC,CAC8hC,MAD9hC,C,CAvM/B9P,gB,CA0MW+P,e,CAAkB,CACjC,YADiC,CACnB,YADmB,CACL,SADK,CACM,WADN,CACmB,YADnB,CACiC,cADjC,CACiD,aADjD,CACgE,WADhE,CAC6E,aAD7E,CAC4F,WAD5F,CACyG,gBADzG,CAC2H,aAD3H,CAC0I,YAD1I,CACwJ,UADxJ,CACoK,QADpK,CAC8K,UAD9K,CAC0L,UAD1L,CACsM,WADtM,CACmN,aADnN,CACkO,WADlO,CAC+O,WAD/O,CAC4P,UAD5P,CACwQ,KADxQ,CAC+Q,SAD/Q,CAC0R,UAD1R,CACsS,aADtS,CACqT,UADrT,CACiU,SADjU,CAC4U,WAD5U,CACyV,YADzV,CACuW,QADvW,CACiX,WADjX,CAC8X,WAD9X,CAC2Y,SAD3Y,CACsZ,aADtZ,CACqa,WADra,CACkb,QADlb,CAC4b,WAD5b,CACyc,gBADzc,CAC2d,aAD3d,CAC0e,YAD1e,CACwf,aADxf,CACugB,aADvgB,CACshB,aADthB,CACqiB,YADriB,CACmjB,aADnjB,CACkkB,WADlkB,CAC+kB,gBAD/kB,CACimB,UADjmB,CAC6mB,YAD7mB,CAC2nB,OAD3nB,CACooB,cADpoB,CACopB,YADppB,CACkqB,eADlqB,CACmrB,aADnrB,C,CA1M7B/P,gB,CA6MWmQ,gB,CAAmB,CAClC,WADkC,CACrB,OADqB,CACZ,QADY,CACF,WADE,CACW,YADX,CACyB,YADzB,CACuC,YADvC,CACqD,SADrD,CACgE,YADhE,CAC8E,aAD9E,CAC6F,aAD7F,CAC4G,aAD5G,CAC2H,WAD3H,CACwI,WADxI,CACqJ,gBADrJ,CACuK,SADvK,CACkL,YADlL,CACgM,YADhM,CAC8M,UAD9M,CAC0N,WAD1N,CACuO,gBADvO,CACyP,YADzP,CACuQ,WADvQ,CACoR,YADpR,CACkS,WADlS,CAC+S,cAD/S,CAC+T,WAD/T,CAC4U,aAD5U,CAC2V,MAD3V,CACmW,UADnW,CAC+W,YAD/W,CAC6X,cAD7X,CAC6Y,UAD7Y,CACyZ,QADzZ,CACma,QADna,CAC6a,aAD7a,C,CA7M9BnQ,gB,CAgNW4P,kB,CAAqB,CACpC,YADoC,CACtB,UADsB,CACV,UADU,CACE,YADF,CACgB,WADhB,CAC6B,OAD7B,CACsC,UADtC,CACkD,WADlD,CAC+D,aAD/D,CAC8E,eAD9E,CAC+F,SAD/F,CAC0G,YAD1G,CACwH,YADxH,CACsI,SADtI,CACiJ,YADjJ,CAC+J,WAD/J,CAC4K,WAD5K,CACyL,WADzL,CACsM,WADtM,C;;;AA0MhCzP,oB;AACLmI,Q,CAAA,mBAAW;AACV,MAAO,CAACiM,QAAQ,CAAE,CAAX,CAAcC,OAAO,CAAE,CAAvB,CAA0BC,MAAM,CAAE,CAAlC,CAAP;AACA,C;AACDzM,iB,CAAA,4BAAiC;AAChC,MAAO;AACN,CAAC,UAAD,CAAa,UAAb,CADM;AAEN,CAAC,UAAD,CAAa,SAAb,CAFM;AAGN,CAAC,UAAD,CAAa,QAAb,CAHM,CAAP;;AAKA,C;AACDE,c,CAAA,yBAAiB;AAChB,MAAO,MAAKF,iBAAL,EAAP;AACA,C;AACDpH,M,CAAA,gBAAOiM,GAAP,CAAuBxN,OAAvB,CAAqD;AACpD,KAAM,IAAI+O,CAAAA,KAAJ,CAAU,gBAAV,CAAN;AACA,C;AACD1F,I,CAAA,cAAKzJ,OAAL,CAA2BG,OAA3B,CAAgE;AAC/D,KAAM,IAAIgP,CAAAA,KAAJ,CAAU,iBAAV,CAAN;AACA,C,+BAnBiCtH,iB;;;AAsB7B5G,gB;AACLoI,Q,CAAA,mBAAW;AACV,GAAI,CAAC,KAAK5I,GAAV,CAAe,MAAOH,CAAAA,MAAM,CAAC4C,eAAd,CAAf;AACK,wBAAW8B,sBAAsB,CAAC,KAAKvE,GAAN,CAAtB,CAAiCkF,iBAA5C,CAAkErF,MAAM,CAAC4C,eAAzE;AACL,C;AACD6F,iB,CAAA,4BAAiC;AAChC,GAAM/I,CAAAA,OAAoB,CAAG,EAA7B;AACA,IAAK,GAAIyC,CAAAA,KAAT,GAAenC,CAAAA,MAAM,CAAC4C,eAAtB,CAAuC;AACtClD,OAAO,CAAC4B,IAAR,CAAa,CAAC,MAAD,CAASa,KAAT,CAAb;AACA;AACD,MAAOzC,CAAAA,OAAP;AACA,C;AACDiJ,c,CAAA,yBAAiB;AAChB,MAAO,MAAKF,iBAAL,EAAP;AACA,C;AACDpH,M,CAAA,gBAAOiM,GAAP,CAAuBxN,OAAvB,CAAqD;AACpD,KAAM,IAAI+O,CAAAA,KAAJ,CAAU,gBAAV,CAAN;AACA,C;AACD1F,I,CAAA,cAAKzJ,OAAL,CAA2BG,OAA3B,CAAgE;AAC/D,KAAM,IAAIgP,CAAAA,KAAJ,CAAU,iBAAV,CAAN;AACA,C,2BApB6BtH,iB","sourcesContent":["/**\n * Search\n *\n * Code for searching for dex information, used by the Dex and\n * Teambuilder.\n *\n * Dependencies: battledata, search-index\n * Optional dependencies: pokedex, moves, items, abilities\n *\n * @author Guangcong Luo <guangcongluo@gmail.com>\n * @license MIT\n */\n\ntype SearchType = (\n\t'pokemon' | 'type' | 'tier' | 'move' | 'item' | 'ability' | 'egggroup' | 'category' | 'article'\n);\n\ntype SearchRow = (\n\t[SearchType, ID, number?, number?] | ['sortpokemon' | 'sortmove', ''] | ['header' | 'html', string]\n);\n\ntype SearchFilter = [string, string];\n\n/** ID, SearchType, index (if alias), offset (if offset alias) */\ndeclare const BattleSearchIndex: [ID, SearchType, number?, number?][];\ndeclare const BattleSearchIndexOffset: any;\ndeclare const BattleTeambuilderTable: any;\n\n/**\n * Backend for search UIs.\n */\n\nclass DexSearch {\n\tquery = '';\n\n\t/**\n\t * Dex for the mod/generation to search.\n\t */\n\tdex: ModdedDex = Dex;\n\n\ttypedSearch: BattleTypedSearch<SearchType> | null = null;\n\n\tresults: SearchRow[] | null = null;\n\texactMatch = false;\n\n\tstatic typeTable = {\n\t\tpokemon: 1,\n\t\ttype: 2,\n\t\ttier: 3,\n\t\tmove: 4,\n\t\titem: 5,\n\t\tability: 6,\n\t\tegggroup: 7,\n\t\tcategory: 8,\n\t\tarticle: 9,\n\t};\n\tstatic typeName = {\n\t\tpokemon: 'Pok&eacute;mon',\n\t\ttype: 'Type',\n\t\ttier: 'Tiers',\n\t\tmove: 'Moves',\n\t\titem: 'Items',\n\t\tability: 'Abilities',\n\t\tegggroup: 'Egg group',\n\t\tcategory: 'Category',\n\t\tarticle: 'Article',\n\t};\n\tfirstPokemonColumn: 'Tier' | 'Number' = 'Number';\n\n\t/**\n\t * Column to sort by. Default is `null`, a smart sort determined by how good\n\t * things are according to the base filters, falling back to dex number (for\n\t * Pokemon) and name (for everything else).\n\t */\n\tsortCol: string | null = null;\n\n\t/**\n\t * Filters for the search result. Does not include the two base filters\n\t * (format and species).\n\t */\n\tfilters: SearchFilter[] | null = null;\n\n\tconstructor(searchType: SearchType | '' = '', formatid = '' as ID, species = '' as ID) {\n\t\tthis.setType(searchType, formatid, species);\n\t\tif (window.room && window.room.curTeam && window.room.curTeam.mod) this.dex = Dex.mod(window.room.curTeam.mod);\n\t}\n\n\tgetTypedSearch(searchType: SearchType | '', format = '' as ID, speciesOrSet: ID | PokemonSet = '' as ID) {\n\t\tif (!searchType) return null;\n\t\tswitch (searchType) {\n\t\tcase 'pokemon': return new BattlePokemonSearch('pokemon', format, speciesOrSet);\n\t\tcase 'item': return new BattleItemSearch('item', format, speciesOrSet);\n\t\tcase 'move': return new BattleMoveSearch('move', format, speciesOrSet);\n\t\tcase 'ability': return new BattleAbilitySearch('ability', format, speciesOrSet);\n\t\tcase 'type': return new BattleTypeSearch('type', format, speciesOrSet);\n\t\tcase 'category': return new BattleCategorySearch('category', format, speciesOrSet);\n\t\t}\n\t\treturn null;\n\t}\n\n\tfind(query: string) {\n\t\tquery = toID(query);\n\t\tif (this.query === query && this.results) {\n\t\t\treturn false;\n\t\t}\n\t\tthis.query = query;\n\t\tif (!query) {\n\t\t\tthis.results = this.typedSearch?.getResults(this.filters, this.sortCol) || [];\n\t\t} else {\n\t\t\tthis.results = this.textSearch(query);\n\t\t}\n\t\treturn true;\n\t}\n\n\tsetType(searchType: SearchType | '', format = '' as ID, speciesOrSet: ID | PokemonSet = '' as ID) {\n\t\t// invalidate caches\n\t\tthis.results = null;\n\n\t\tif (searchType !== this.typedSearch?.searchType) {\n\t\t\tthis.filters = null;\n\t\t\tthis.sortCol = null;\n\t\t}\n\t\tthis.typedSearch = this.getTypedSearch(searchType, format, speciesOrSet);\n\t\tif (this.typedSearch) this.dex = this.typedSearch.dex;\n\t}\n\n\taddFilter(entry: SearchFilter): boolean {\n\t\tif (!this.typedSearch) return false;\n\t\tlet [type] = entry;\n\t\tif (this.typedSearch.searchType === 'pokemon') {\n\t\t\tif (type === this.sortCol) this.sortCol = null;\n\t\t\tif (!['type', 'move', 'ability', 'egggroup', 'tier'].includes(type)) return false;\n\t\t\tif (type === 'move') entry[1] = toID(entry[1]);\n\t\t\tif (!this.filters) this.filters = [];\n\t\t\tthis.results = null;\n\t\t\tfor (const filter of this.filters) {\n\t\t\t\tif (filter[0] === type && filter[1] === entry[1]) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.filters.push(entry);\n\t\t\treturn true;\n\t\t} else if (this.typedSearch.searchType === 'move') {\n\t\t\tif (type === this.sortCol) this.sortCol = null;\n\t\t\tif (!['type', 'category', 'pokemon'].includes(type)) return false;\n\t\t\tif (type === 'pokemon') entry[1] = toID(entry[1]);\n\t\t\tif (!this.filters) this.filters = [];\n\t\t\tthis.filters.push(entry);\n\t\t\tthis.results = null;\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tremoveFilter(entry?: SearchFilter): boolean {\n\t\tif (!this.filters) return false;\n\t\tif (entry) {\n\t\t\tconst filterid = entry.join(':');\n\t\t\tlet deleted: string[] | null = null;\n\t\t\t// delete specific filter\n\t\t\tfor (let i = 0; i < this.filters.length; i++) {\n\t\t\t\tif (filterid === this.filters[i].join(':')) {\n\t\t\t\t\tdeleted = this.filters[i];\n\t\t\t\t\tthis.filters.splice(i, 1);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!deleted) return false;\n\t\t} else {\n\t\t\tthis.filters.pop();\n\t\t}\n\t\tif (!this.filters.length) this.filters = null;\n\t\tthis.results = null;\n\t\treturn true;\n\t}\n\n\ttoggleSort(sortCol: string) {\n\t\tif (this.sortCol === sortCol) {\n\t\t\tthis.sortCol = null;\n\t\t} else {\n\t\t\tthis.sortCol = sortCol;\n\t\t}\n\t\tthis.results = null;\n\t}\n\n\tfilterLabel(filterType: string) {\n\t\tif (this.typedSearch && this.typedSearch.searchType !== filterType) {\n\t\t\treturn 'Filter';\n\t\t}\n\t\treturn null;\n\t}\n\tillegalLabel(id: ID) {\n\t\treturn this.typedSearch?.illegalReasons?.[id] || null;\n\t}\n\n\tgetTier(species: Species) {\n\t\treturn this.typedSearch?.getTier(species) || '';\n\t}\n\n\ttextSearch(query: string): SearchRow[] {\n\t\tquery = toID(query);\n\n\t\tthis.exactMatch = false;\n\t\tlet searchType: SearchType | '' = this.typedSearch?.searchType || '';\n\n\t\t// If searchType exists, we're searching mainly for results of that type.\n\t\t// We'll still search for results of other types, but those results\n\t\t// will only be used to filter results for that type.\n\t\tlet searchTypeIndex = (searchType ? DexSearch.typeTable[searchType] : -1);\n\n\t\t/** searching for \"Psychic type\" will make the type come up over the move */\n\t\tlet qFilterType: 'type' | '' = '';\n\t\tif (query.slice(-4) === 'type') {\n\t\t\tif ((query.charAt(0).toUpperCase() + query.slice(1, -4)) in window.BattleTypeChart) {\n\t\t\t\tquery = query.slice(0, -4);\n\t\t\t\tqFilterType = 'type';\n\t\t\t}\n\t\t}\n\n\t\t// i represents the location of the search index we're looking at\n\t\tlet i = DexSearch.getClosest(query);\n\t\tthis.exactMatch = (BattleSearchIndex[i][0] === query);\n\n\t\t// Even with output buffer buckets, we make multiple passes through\n\t\t// the search index. searchPasses is a queue of which pass we're on:\n\t\t// [passType, i, query]\n\n\t\t// By doing an alias pass after the normal pass, we ensure that\n\t\t// mid-word matches only display after start matches.\n\t\tlet passType: SearchPassType | '' = '';\n\t\t/**\n\t\t * pass types:\n\t\t * * '': time to pop the next pass off the searchPasses queue\n\t\t * * 'normal': start at i and stop when results no longer start with query\n\t\t * * 'alias': like normal, but output aliases instead of non-alias results\n\t\t * * 'fuzzy': start at i and stop when you have two results\n\t\t * * 'exact': like normal, but stop at i\n\t\t */\n\t\ttype SearchPassType = 'normal' | 'alias' | 'fuzzy' | 'exact';\n\t\t/**\n\t\t * [passType, i, query]\n\t\t *\n\t\t * i = index of BattleSearchIndex to start from\n\t\t *\n\t\t * By doing an alias pass after the normal pass, we ensure that\n\t\t * mid-word matches only display after start matches.\n\t\t */\n\t\ttype SearchPass = [SearchPassType, number, string];\n\t\tlet searchPasses: SearchPass[] = [['normal', i, query]];\n\n\t\t// For performance reasons, only do an alias pass if query is at\n\t\t// least 2 chars long\n\t\tif (query.length > 1) searchPasses.push(['alias', i, query]);\n\n\t\t// If the query matches an official alias in BattleAliases: These are\n\t\t// different from the aliases in the search index and are given\n\t\t// higher priority. We'll do a normal pass through the index with\n\t\t// the alias text before any other passes.\n\t\tlet queryAlias;\n\t\tif (query in BattleAliases) {\n\t\t\tif (['sub', 'tr'].includes(query) || toID(BattleAliases[query]).slice(0, query.length) !== query) {\n\t\t\t\tqueryAlias = toID(BattleAliases[query]);\n\t\t\t\tlet aliasPassType: SearchPassType = (queryAlias === 'hiddenpower' ? 'exact' : 'normal');\n\t\t\t\tsearchPasses.unshift([aliasPassType, DexSearch.getClosest(queryAlias), queryAlias]);\n\t\t\t}\n\t\t\tthis.exactMatch = true;\n\t\t}\n\n\t\t// If there are no matches starting with query: Do a fuzzy match pass\n\t\t// Fuzzy matches will still be shown after alias matches\n\t\tif (!this.exactMatch && BattleSearchIndex[i][0].substr(0, query.length) !== query) {\n\t\t\t// No results start with this. Do a fuzzy match pass.\n\t\t\tlet matchLength = query.length - 1;\n\t\t\tif (!i) i++;\n\t\t\twhile (matchLength &&\n\t\t\t\tBattleSearchIndex[i][0].substr(0, matchLength) !== query.substr(0, matchLength) &&\n\t\t\t\tBattleSearchIndex[i - 1][0].substr(0, matchLength) !== query.substr(0, matchLength)) {\n\t\t\t\tmatchLength--;\n\t\t\t}\n\t\t\tlet matchQuery = query.substr(0, matchLength);\n\t\t\twhile (i >= 1 && BattleSearchIndex[i - 1][0].substr(0, matchLength) === matchQuery) i--;\n\t\t\tsearchPasses.push(['fuzzy', i, '']);\n\t\t}\n\n\t\t// We split the output buffers into 8 buckets.\n\t\t// Bucket 0 is usually unused, and buckets 1-7 represent\n\t\t// pokemon, types, moves, etc (see typeTable).\n\n\t\t// When we're done, the buffers are concatenated together to form\n\t\t// our results, with each buffer getting its own header, unlike\n\t\t// multiple-pass results, which have no header.\n\n\t\t// Notes:\n\t\t// - if we have a searchType, that searchType's buffer will be on top\n\t\tlet bufs: SearchRow[][] = [[], [], [], [], [], [], [], [], [], []];\n\t\tlet topbufIndex = -1;\n\n\t\tlet count = 0;\n\t\tlet nearMatch = false;\n\n\t\t/** [type, id, typeIndex] */\n\t\tlet instafilter: [SearchType, ID, number] | null = null;\n\t\tlet instafilterSort = [0, 1, 2, 5, 4, 3, 6, 7, 8];\n\t\tlet illegal = this.typedSearch?.illegalReasons;\n\n\t\t// We aren't actually looping through the entirety of the searchIndex\n\t\tfor (i = 0; i < BattleSearchIndex.length; i++) {\n\t\t\tif (!passType) {\n\t\t\t\tlet searchPass = searchPasses.shift();\n\t\t\t\tif (!searchPass) break;\n\t\t\t\tpassType = searchPass[0];\n\t\t\t\ti = searchPass[1];\n\t\t\t\tquery = searchPass[2];\n\t\t\t}\n\n\t\t\tlet entry = BattleSearchIndex[i];\n\t\t\tlet id = entry[0];\n\t\t\tlet type = entry[1];\n\n\t\t\tif (!id) break;\n\n\t\t\tif (passType === 'fuzzy') {\n\t\t\t\t// fuzzy match pass; stop after 2 results\n\t\t\t\tif (count >= 2) {\n\t\t\t\t\tpassType = '';\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tnearMatch = true;\n\t\t\t} else if (passType === 'exact') {\n\t\t\t\t// exact pass; stop after 1 result\n\t\t\t\tif (count >= 1) {\n\t\t\t\t\tpassType = '';\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t} else if (id.substr(0, query.length) !== query) {\n\t\t\t\t// regular pass, time to move onto our next match\n\t\t\t\tpassType = '';\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (entry.length > 2) {\n\t\t\t\t// alias entry\n\t\t\t\tif (passType !== 'alias') continue;\n\t\t\t} else {\n\t\t\t\t// normal entry\n\t\t\t\tif (passType === 'alias') continue;\n\t\t\t}\n\n\t\t\tlet typeIndex = DexSearch.typeTable[type];\n\t\t\t// For performance, with a query length of 1, we only fill the first bucket\n\t\t\tif (query.length === 1 && typeIndex !== (searchType ? searchTypeIndex : 1)) continue;\n\n\t\t\t// For pokemon queries, accept types/tier/abilities/moves/eggroups as filters\n\t\t\tif (searchType === 'pokemon' && (typeIndex === 5 || typeIndex > 7)) continue;\n\t\t\tif (searchType === 'pokemon' && typeIndex === 3 && this.dex.gen < 8) continue;\n\t\t\t// For move queries, accept types/categories as filters\n\t\t\tif (searchType === 'move' && ((typeIndex !== 8 && typeIndex > 4) || typeIndex === 3)) continue;\n\t\t\t// For move queries in the teambuilder, don't accept pokemon as filters\n\t\t\tif (searchType === 'move' && illegal && typeIndex === 1) continue;\n\t\t\t// For ability/item queries, don't accept anything else as a filter\n\t\t\tif ((searchType === 'ability' || searchType === 'item') && typeIndex !== searchTypeIndex) continue;\n\t\t\t// Query was a type name followed 'type'; only show types\n\t\t\tif (qFilterType === 'type' && typeIndex !== 2) continue;\n\t\t\t// hardcode cases of duplicate non-consecutive aliases\n\t\t\tif ((id === 'megax' || id === 'megay') && 'mega'.startsWith(query)) continue;\n\n\t\t\tlet matchStart = 0;\n\t\t\tlet matchEnd = 0;\n\t\t\tif (passType === 'alias') {\n\t\t\t\t// alias entry\n\t\t\t\t// [aliasid, type, originalid, matchStart, originalindex]\n\t\t\t\tmatchStart = entry[3]!;\n\t\t\t\tlet originalIndex = entry[2]!;\n\t\t\t\tif (matchStart) {\n\t\t\t\t\tmatchEnd = matchStart + query.length;\n\t\t\t\t\tmatchStart += (BattleSearchIndexOffset[originalIndex][matchStart] || '0').charCodeAt(0) - 48;\n\t\t\t\t\tmatchEnd += (BattleSearchIndexOffset[originalIndex][matchEnd - 1] || '0').charCodeAt(0) - 48;\n\t\t\t\t}\n\t\t\t\tid = BattleSearchIndex[originalIndex][0];\n\t\t\t} else {\n\t\t\t\tmatchEnd = query.length;\n\t\t\t\tif (matchEnd) matchEnd += (BattleSearchIndexOffset[i][matchEnd - 1] || '0').charCodeAt(0) - 48;\n\t\t\t}\n\n\t\t\t// some aliases are substrings\n\t\t\tif (queryAlias === id && query !== id) continue;\n\n\t\t\tif (searchType && searchTypeIndex !== typeIndex) {\n\t\t\t\t// This is a filter, set it as an instafilter candidate\n\t\t\t\tif (!instafilter || instafilterSort[typeIndex] < instafilterSort[instafilter[2]]) {\n\t\t\t\t\tinstafilter = [type, id, typeIndex];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// show types above Arceus formes\n\t\t\tif (topbufIndex < 0 && searchTypeIndex < 2 && passType === 'alias' && !bufs[1].length && bufs[2].length) {\n\t\t\t\ttopbufIndex = 2;\n\t\t\t}\n\n\t\t\t// determine if the element comes from the current mod\n\t\t\tconst table = BattleTeambuilderTable['gen8'];\n\t\t\tif (window.room && window.room.curTeam) table = BattleTeambuilderTable[window.room.curTeam.mod];\n\t\t\tif (\n\t\t\t\ttypeIndex === 1 && (!BattlePokedex[id] || BattlePokedex[id].exists === false) &&\n\t\t\t\t(!table || !table.overrideDexInfo || id in table.overrideDexInfo === false)\n\t\t\t) continue;\n\t\t\telse if (\n\t\t\t\ttypeIndex === 5 && (!BattleItems[id] || BattleItems[id].exists === false) &&\n\t\t\t\t(!table || !table.overrideItemDesc || id in table.overrideItemDesc === false)\n\t\t\t) continue;\n\t\t\telse if (\n\t\t\t\ttypeIndex === 4 && (!BattleMovedex[id] || BattleMovedex[id].exists === false) &&\n\t\t\t\t(!table || !table.overrideMoveInfo || id in table.overrideMoveInfo === false)\n\t\t\t) continue;\n\t\t\telse if (\n\t\t\t\ttypeIndex === 6 && (!BattleAbilities[id] || BattleAbilities[id].exists === false) &&\n\t\t\t\t(!table || !table.overrideAbilityDesc || id in table.overrideAbilityDesc === false)\n\t\t\t) continue;\n\t\t\telse if (\n\t\t\t\ttypeIndex === 2 && id.replace(id.charAt(0), id.charAt(0).toUpperCase()) in window.BattleTypeChart === false &&\n\t\t\t\t(!table || id.replace(id.charAt(0), id.charAt(0).toUpperCase()) in table.overrideTypeChart === false)\n\t\t\t) continue;\n\n\t\t\tif (illegal && typeIndex === searchTypeIndex) {\n\t\t\t\t// Always show illegal results under legal results.\n\t\t\t\t// This is done by putting legal results (and the type header)\n\t\t\t\t// in bucket 0, and illegal results in the searchType's bucket.\n\t\t\t\t// searchType buckets are always on top (but under bucket 0), so\n\t\t\t\t// illegal results will be seamlessly right under legal results.\n\t\t\t\tif (!bufs[typeIndex].length && !bufs[0].length) {\n\t\t\t\t\tbufs[0] = [['header', DexSearch.typeName[type]]];\n\t\t\t\t}\n\t\t\t\tif (!(id in illegal)) typeIndex = 0;\n\t\t\t} else {\n\t\t\t\tif (!bufs[typeIndex].length) {\n\t\t\t\t\tbufs[typeIndex] = [['header', DexSearch.typeName[type]]];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// don't match duplicate aliases\n\t\t\tlet curBufLength = (passType === 'alias' && bufs[typeIndex].length);\n\t\t\tif (curBufLength && bufs[typeIndex][curBufLength - 1][1] === id) continue;\n\n\t\t\tbufs[typeIndex].push([type, id, matchStart, matchEnd]);\n\t\t\tcount++;\n\t\t}\n\n\t\tlet topbuf: SearchRow[] = [];\n\t\tif (nearMatch) {\n\t\t\ttopbuf = [['html', `<em>No exact match found. The closest matches alphabetically are:</em>`]];\n\t\t}\n\t\tif (topbufIndex >= 0) {\n\t\t\ttopbuf = topbuf.concat(bufs[topbufIndex]);\n\t\t\tbufs[topbufIndex] = [];\n\t\t}\n\t\tif (searchTypeIndex >= 0) {\n\t\t\ttopbuf = topbuf.concat(bufs[0]);\n\t\t\ttopbuf = topbuf.concat(bufs[searchTypeIndex]);\n\t\t\tbufs[searchTypeIndex] = [];\n\t\t\tbufs[0] = [];\n\t\t}\n\n\t\tif (instafilter && count < 20) {\n\t\t\t// Result count is less than 20, so we can instafilter\n\t\t\tbufs.push(this.instafilter(searchType, instafilter[0], instafilter[1]));\n\t\t}\n\n\t\tthis.results = Array.prototype.concat.apply(topbuf, bufs);\n\t\treturn this.results;\n\t}\n\tprivate instafilter(searchType: SearchType | '', fType: SearchType, fId: ID): SearchRow[] {\n\t\tlet buf: SearchRow[] = [];\n\t\tlet illegalBuf: SearchRow[] = [];\n\t\tlet illegal = this.typedSearch?.illegalReasons;\n\t\t// Change object to look in if using a mod\n\t\tlet pokedex = BattlePokedex;\n\t\tlet moveDex = BattleMovedex;\n\t\tif (window.room && window.room.curTeam && window.room.curTeam.mod) {\n\t\t\tpokedex = {};\n\t\t\tmoveDex = {};\n\t\t\tconst table = BattleTeambuilderTable[window.room.curTeam.mod];\n\t\t\tfor (const id in table.overrideDexInfo) {\n\t\t\t\tpokedex[id] = {\n\t\t\t\t\ttypes: table.overrideDexInfo[id].types,\n\t\t\t\t\tabilities: table.overrideDexInfo[id].abilities,\n\t\t\t\t};\n\t\t\t}\n\t\t\tfor (const id in table.overrideMoveInfo) {\n\t\t\t\tmoveDex[id] = {\n\t\t\t\t\ttype: table.overrideMoveInfo.type,\n\t\t\t\t\tcategory: table.overrideMoveInfo.category,\n\t\t\t\t\tbasePower: table.overrideMoveInfo.basePower,\n\t\t\t\t};\n\t\t\t}\n\t\t\tpokedex = {...pokedex, ...BattlePokedex};\n\t\t\tmoveDex = {...moveDex, ...BattleMovedex};\n\t\t}\n\t\tif (searchType === 'pokemon') {\n\t\t\tswitch (fType) {\n\t\t\tcase 'type':\n\t\t\t\tlet type = fId.charAt(0).toUpperCase() + fId.slice(1) as TypeName;\n\t\t\t\tbuf.push(['header', `${type}-type Pok&eacute;mon`]);\n\t\t\t\tfor (let id in pokedex) {\n\t\t\t\t\tif (!pokedex[id].types) continue;\n\t\t\t\t\tif (this.dex.getSpecies(id).types.includes(type)) {\n\t\t\t\t\t\t(illegal && id in illegal ? illegalBuf : buf).push(['pokemon', id as ID]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'ability':\n\t\t\t\tlet ability = this.dex.getAbility(fId).name;\n\t\t\t\tbuf.push(['header', `${ability} Pok&eacute;mon`]);\n\t\t\t\tfor (let id in pokedex) {\n\t\t\t\t\tif (!pokedex[id].abilities) continue;\n\t\t\t\t\tif (Dex.hasAbility(this.dex.getSpecies(id), ability)) {\n\t\t\t\t\t\t(illegal && id in illegal ? illegalBuf : buf).push(['pokemon', id as ID]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t} else if (searchType === 'move') {\n\t\t\tswitch (fType) {\n\t\t\tcase 'type':\n\t\t\t\tlet type = fId.charAt(0).toUpperCase() + fId.slice(1);\n\t\t\t\tbuf.push(['header', `${type}-type moves`]);\n\t\t\t\tfor (let id in moveDex) {\n\t\t\t\t\tif (moveDex[id].type === type) {\n\t\t\t\t\t\t(illegal && id in illegal ? illegalBuf : buf).push(['move', id as ID]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'category':\n\t\t\t\tlet category = fId.charAt(0).toUpperCase() + fId.slice(1);\n\t\t\t\tbuf.push(['header', `${category} moves`]);\n\t\t\t\tfor (let id in moveDex) {\n\t\t\t\t\tif (moveDex[id].category === category) {\n\t\t\t\t\t\t(illegal && id in illegal ? illegalBuf : buf).push(['move', id as ID]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn [...buf, ...illegalBuf];\n\t}\n\n\tstatic getClosest(query: string) {\n\t\t// binary search through the index!\n\t\tlet left = 0;\n\t\tlet right = BattleSearchIndex.length - 1;\n\t\twhile (right > left) {\n\t\t\tlet mid = Math.floor((right - left) / 2 + left);\n\t\t\tif (BattleSearchIndex[mid][0] === query && (mid === 0 || BattleSearchIndex[mid - 1][0] !== query)) {\n\t\t\t\t// that's us\n\t\t\t\treturn mid;\n\t\t\t} else if (BattleSearchIndex[mid][0] < query) {\n\t\t\t\tleft = mid + 1;\n\t\t\t} else {\n\t\t\t\tright = mid - 1;\n\t\t\t}\n\t\t}\n\t\tif (left >= BattleSearchIndex.length - 1) left = BattleSearchIndex.length - 1;\n\t\telse if (BattleSearchIndex[left + 1][0] && BattleSearchIndex[left][0] < query) left++;\n\t\tif (left && BattleSearchIndex[left - 1][0] === query) left--;\n\t\treturn left;\n\t}\n}\n\nabstract class BattleTypedSearch<T extends SearchType> {\n\tsearchType: T;\n\t/**\n\t * Dex for the mod/generation to search.\n\t */\n\tdex: ModdedDex = Dex;\n\t/**\n\t * Format is the first of two base filters. It constrains results to things\n\t * legal in the format, and affects the default sort.\n\t *\n\t * This string specifically normalizes out generation number and the words\n\t * \"Doubles\" and \"Let's Go\" from the name.\n\t *\n\t * mod formats can set the format variable to a standard format, so modFormat\n\t * keeps track of the original format in such a case\n\t */\n\tformat = '' as ID;\n\tmodFormat = '' as ID;\n\t/**\n\t * `species` is the second of two base filters. It constrains results to\n\t * things that species can use, and affects the default sort.\n\t */\n\tspecies = '' as ID;\n\t/**\n\t * `set` is a pseudo-base filter; it has minor effects on move sorting.\n\t * (Abilities/items can affect what moves are sorted as usable.)\n\t */\n\tset: PokemonSet | null = null;\n\tmod = '';\n\n\tprotected formatType: 'doubles' | 'letsgo' | 'metronome' | 'natdex' | 'nfe' | 'dlc1' | 'dlc1doubles' | null = null;\n\n\t/**\n\t * Cached copy of what the results list would be with only base filters\n\t * (i.e. with an empty `query` and `filters`)\n\t */\n\tbaseResults: SearchRow[] | null = null;\n\t/**\n\t * Cached copy of all results not in `baseResults` - mostly in case a user\n\t * is wondering why a specific result isn't showing up.\n\t */\n\tbaseIllegalResults: SearchRow[] | null = null;\n\tillegalReasons: {[id: string]: string} | null = null;\n\tresults: SearchRow[] | null = null;\n\n\tprotected readonly sortRow: SearchRow | null = null;\n\n\tconstructor(searchType: T, format = '' as ID, speciesOrSet: ID | PokemonSet = '' as ID) {\n\t\tthis.searchType = searchType;\n\t\tthis.baseResults = null;\n\t\tthis.baseIllegalResults = null;\n\t\tthis.modFormat = format;\n\t\tlet gen = 8;\n\t\tconst ClientMods = window.ModConfig;\n\t\tif (format.slice(0, 3) === 'gen') {\n\t\t\tgen = (Number(format.charAt(3)) || 6);\n\t\t\tlet mod = '';\n\t\t\tlet overrideFormat = '';\n\t\t\tlet modFormatType = '';\n\t\t\tfor (const modid in (ClientMods)) {\n\t\t\t\tfor (const formatid in ClientMods[modid].formats) {\n\t\t\t\t\tif (formatid === format) {\n\t\t\t\t\t\tmod = modid;\n\t\t\t\t\t\tconst formatTable = ClientMods[modid].formats[formatid];\n\t\t\t\t\t\tif (mod && formatTable.teambuilderFormat) overrideFormat = toID(formatTable.teambuilderFormat);\n\t\t\t\t\t\tif (mod && formatTable.formatType) modFormatType = toID(formatTable.formatType);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (mod) {\n\t\t\t\tthis.dex = Dex.mod(mod as ID);\n\t\t\t\tthis.dex.gen = gen;\n\t\t\t\tthis.mod = mod;\n\t\t\t} else {\n\t\t\t\tthis.dex = Dex.forGen(gen);\n\t\t\t}\n\t\t\tif (overrideFormat) format = overrideFormat as ID;\n\t\t\telse format = (format.slice(4) || 'customgame') as ID;\n\t\t\tif (modFormatType) this.formatType = modFormatType as 'doubles' | 'letsgo' | 'metronome' | 'natdex' | 'nfe' | 'dlc1' | 'dlc1doubles' | null;\n\t\t} else if (!format) {\n\t\t\tthis.dex = Dex;\n\t\t}\n\t\tif (format.startsWith('dlc1')) {\n\t\t\tif (format.includes('doubles')) {\n\t\t\t\tthis.formatType = 'dlc1doubles';\n\t\t\t} else {\n\t\t\t\tthis.formatType = 'dlc1';\n\t\t\t}\n\t\t\tformat = format.slice(4) as ID;\n\t\t}\n\t\tif (format === 'vgc2020') this.formatType = 'dlc1doubles';\n\t\tif (format.includes('doubles') && this.dex.gen > 4 && !this.formatType) this.formatType = 'doubles';\n\t\tif (format.includes('letsgo')) this.formatType = 'letsgo';\n\t\tif (format.includes('nationaldex')) {\n\t\t\tformat = format.slice(11) as ID;\n\t\t\tthis.formatType = 'natdex';\n\t\t\tif (!format) format = 'ou' as ID;\n\t\t}\n\t\tif (this.formatType === 'letsgo') format = format.slice(6) as ID;\n\t\tif (format.includes('metronome')) {\n\t\t\tthis.formatType = 'metronome';\n\t\t}\n\t\tif (format.endsWith('nfe')) {\n\t\t\tformat = format.slice(3) as ID;\n\t\t\tthis.formatType = 'nfe';\n\t\t\tif (!format) format = 'ou' as ID;\n\t\t}\n\t\tthis.format = format;\n\n\t\tthis.species = '' as ID;\n\t\tthis.set = null;\n\t\tif (typeof speciesOrSet === 'string') {\n\t\t\tif (speciesOrSet) this.species = speciesOrSet;\n\t\t} else {\n\t\t\tthis.set = speciesOrSet as PokemonSet;\n\t\t\tthis.species = toID(this.set.species);\n\t\t}\n\t\tif (!searchType || !this.set) return;\n\t}\n\tgetResults(filters?: SearchFilter[] | null, sortCol?: string | null): SearchRow[] {\n\t\tif (sortCol === 'type') {\n\t\t\treturn [this.sortRow!, ...BattleTypeSearch.prototype.getDefaultResults.call(this)];\n\t\t} else if (sortCol === 'category') {\n\t\t\treturn [this.sortRow!, ...BattleCategorySearch.prototype.getDefaultResults.call(this)];\n\t\t} else if (sortCol === 'ability') {\n\t\t\treturn [this.sortRow!, ...BattleAbilitySearch.prototype.getDefaultResults.call(this)];\n\t\t}\n\t\tif (!this.baseResults) {\n\t\t\tthis.baseResults = this.getBaseResults();\n\t\t}\n\n\t\tif (!this.baseIllegalResults) {\n\t\t\tconst legalityFilter: {[id: string]: 1} = {};\n\t\t\tfor (const [resultType, value] of this.baseResults) {\n\t\t\t\tif (resultType === this.searchType) legalityFilter[value] = 1;\n\t\t\t}\n\t\t\tthis.baseIllegalResults = [];\n\t\t\tthis.illegalReasons = {};\n\n\t\t\tfor (const id in this.getTable()) {\n\t\t\t\tif (!(id in legalityFilter)) {\n\t\t\t\t\tthis.baseIllegalResults.push([this.searchType, id as ID]);\n\t\t\t\t\tthis.illegalReasons[id] = 'Illegal';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tlet results: SearchRow[];\n\t\tlet illegalResults: SearchRow[] | null;\n\n\t\tif (filters) {\n\t\t\tresults = [];\n\t\t\tillegalResults = [];\n\t\t\tfor (const result of this.baseResults) {\n\t\t\t\tif (this.filter(result, filters)) {\n\t\t\t\t\tif (results.length && result[0] === 'header' && results[results.length - 1][0] === 'header') {\n\t\t\t\t\t\tresults[results.length - 1] = result;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresults.push(result);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (results.length && results[results.length - 1][0] === 'header') {\n\t\t\t\tresults.pop();\n\t\t\t}\n\t\t\tfor (const result of this.baseIllegalResults) {\n\t\t\t\tif (this.filter(result, filters)) {\n\t\t\t\t\tillegalResults.push(result);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tresults = [...this.baseResults];\n\t\t\tillegalResults = null;\n\t\t}\n\n\t\tif (sortCol) {\n\t\t\tresults = results.filter(([rowType]) => rowType === this.searchType);\n\t\t\tresults = this.sort(results, sortCol);\n\t\t\tif (illegalResults) {\n\t\t\t\tillegalResults = illegalResults.filter(([rowType]) => rowType === this.searchType);\n\t\t\t\tillegalResults = this.sort(illegalResults, sortCol);\n\t\t\t}\n\t\t}\n\n\t\tif (this.sortRow) {\n\t\t\tresults = [this.sortRow, ...results];\n\t\t}\n\t\tif (illegalResults && illegalResults.length) {\n\t\t\tresults = [...results, ['header', \"Illegal results\"], ...illegalResults];\n\t\t}\n\t\treturn results;\n\t}\n\tprotected firstLearnsetid(speciesid: ID) {\n\t\tlet learnsets = BattleTeambuilderTable.learnsets;\n\t\tif (speciesid in learnsets) return speciesid;\n\t\tconst species = this.dex.getSpecies(speciesid);\n\t\tif (!species.exists) return '' as ID;\n\t\tlet baseLearnsetid = toID(species.baseSpecies);\n\t\tif (typeof species.battleOnly === 'string' && species.battleOnly !== species.baseSpecies) {\n\t\t\tbaseLearnsetid = toID(species.battleOnly);\n\t\t}\n\t\tif (baseLearnsetid in learnsets) return baseLearnsetid;\n\t\treturn '' as ID;\n\t}\n\tprotected nextLearnsetid(learnsetid: ID, speciesid: ID) {\n\t\tif (learnsetid === 'lycanrocdusk' || (speciesid === 'rockruff' && learnsetid === 'rockruff')) {\n\t\t\treturn 'rockruffdusk' as ID;\n\t\t}\n\t\tconst lsetSpecies = this.dex.getSpecies(learnsetid);\n\t\tif (!lsetSpecies.exists) return '' as ID;\n\n\t\tif (lsetSpecies.id === 'gastrodoneast') return 'gastrodon' as ID;\n\t\tif (lsetSpecies.id === 'pumpkaboosuper') return 'pumpkaboo' as ID;\n\n\t\tconst next = lsetSpecies.battleOnly || lsetSpecies.changesFrom || lsetSpecies.prevo;\n\t\tif (next) return toID(next);\n\n\t\treturn '' as ID;\n\t}\n\tprotected canLearn(speciesid: ID, moveid: ID) {\n\t\tif (this.dex.gen >= 8 && this.dex.getMove(moveid).isNonstandard === 'Past' && this.formatType !== 'natdex') {\n\t\t\treturn false;\n\t\t}\n\t\tlet genChar = `${this.dex.gen}`;\n\t\tif (\n\t\t\tthis.format.startsWith('vgc') ||\n\t\t\tthis.format.startsWith('battlespot') ||\n\t\t\tthis.format.startsWith('battlestadium')\n\t\t) {\n\t\t\tif (this.dex.gen === 8) {\n\t\t\t\tgenChar = 'g';\n\t\t\t} else if (this.dex.gen === 7) {\n\t\t\t\tgenChar = 'q';\n\t\t\t} else if (this.dex.gen === 6) {\n\t\t\t\tgenChar = 'p';\n\t\t\t}\n\t\t}\n\t\tlet learnsetid = this.firstLearnsetid(speciesid);\n\t\twhile (learnsetid) {\n\t\t\tlet learnset = BattleTeambuilderTable.learnsets[learnsetid];\n\t\t\tif (this.mod) {\n\t\t\t\tconst overrideLearnsets = BattleTeambuilderTable[this.mod].overrideLearnsets;\n\t\t\t\tif (overrideLearnsets[learnsetid] && overrideLearnsets[learnsetid][moveid]) learnset = overrideLearnsets[learnsetid];\n\t\t\t}\n\t\t\tif (learnset && (moveid in learnset) && learnset[moveid].includes(genChar)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tlearnsetid = this.nextLearnsetid(learnsetid, speciesid);\n\t\t}\n\t\treturn false;\n\t}\n\tgetTier(pokemon: Species) {\n\t\tif (this.formatType === 'metronome' || this.formatType === 'natdex') {\n\t\t\treturn pokemon.num >= 0 ? String(pokemon.num) : pokemon.tier;\n\t\t}\n\t\tconst modFormatTable = this.mod ? window.ModConfig[this.mod].formats[this.modFormat] : {};\n\t\tlet table = window.BattleTeambuilderTable;\n\t\tif (this.mod) table = modFormatTable.gameType !== 'doubles' ? BattleTeambuilderTable[this.mod] : BattleTeambuilderTable[this.mod].doubles;\n\t\tconst tableKey = this.formatType === 'doubles' ? `gen${this.dex.gen}doubles` :\n\t\t\tthis.formatType === 'letsgo' ? 'letsgo' :\n\t\t\tthis.formatType === 'nfe' ? `gen${this.dex.gen}nfe` :\n\t\t\tthis.formatType === 'dlc1' ? 'gen8dlc1' :\n\t\t\tthis.formatType === 'dlc1doubles' ? 'gen8dlc1doubles' :\n\t\t\t`gen${this.dex.gen}`;\n\t\tif (table && table[tableKey]) {\n\t\t\ttable = table[tableKey];\n\t\t}\n\t\tif (!table) return pokemon.tier;\n\t\tlet id = pokemon.id;\n\t\tif (id in table.overrideTier) {\n\t\t\treturn table.overrideTier[id];\n\t\t}\n\t\tif (id.slice(-5) === 'totem' && id.slice(0, -5) in table.overrideTier) {\n\t\t\treturn table.overrideTier[id.slice(0, -5)];\n\t\t}\n\t\tid = toID(pokemon.baseSpecies);\n\t\tif (id in table.overrideTier) {\n\t\t\treturn table.overrideTier[id];\n\t\t}\n\t\treturn pokemon.tier;\n\t}\n\tabstract getTable(): {[id: string]: any};\n\tabstract getDefaultResults(): SearchRow[];\n\tabstract getBaseResults(): SearchRow[];\n\tabstract filter(input: SearchRow, filters: string[][]): boolean;\n\tabstract sort(input: SearchRow[], sortCol: string): SearchRow[];\n}\n\nfunction requireNoCache(pathSpec) {\n\tdelete require.cache[require.resolve(pathSpec)];\n\treturn require(pathSpec);\n}\n\nclass BattlePokemonSearch extends BattleTypedSearch<'pokemon'> {\n\tsortRow: SearchRow = ['sortpokemon', ''];\n\tgetTable() {\n\t\tif (!this.mod) return BattlePokedex;\n\t\telse return {...BattleTeambuilderTable[this.mod].overrideDexInfo, ...BattlePokedex};\n\t}\n\tgetDefaultResults(): SearchRow[] {\n\t\tconst metagameHeaders = requireNoCache('../data/metagame-headers.js').MetagameHeaders;\n\t\tlet results: SearchRow[] = [];\n\t\tfor (let id in BattlePokedex) {\n\t\t\tif(id === 'pikachucosplay') continue;\n\t\t\tif(metagameHeaders[id]){\n\t\t\t\tresults.push(['header', metagameHeaders[id]]);\n\t\t\t}\n\t\t\tresults.push(['pokemon', id as ID]);\n\t\t}\n\t\treturn results;\n\t}\n\tgetBaseResults(): SearchRow[] {\n\t\tconst format = this.format;\n\t\tif (!format) return this.getDefaultResults();\n\t\tconst requirePentagon = format === 'battlespotsingles' || format === 'battledoubles' || format.startsWith('vgc');\n\t\tlet isDoublesOrBS = this.formatType === 'doubles';\n\t\tconst dex = this.dex;\n\t\tconst modFormatTable = this.mod ? window.ModConfig[this.mod].formats[this.modFormat] : {};\n\t\tlet table = BattleTeambuilderTable;\n\t\tif (this.mod) {\n\t\t\ttable = modFormatTable.gameType !== 'doubles' ? BattleTeambuilderTable[this.mod] : BattleTeambuilderTable[this.mod].doubles;\n\t\t} else if (format.endsWith('cap') || format.endsWith('caplc')) {\n\t\t\t// CAP formats always use the singles table\n\t\t\tif (dex.gen < 8) {\n\t\t\t\ttable = table['gen' + dex.gen];\n\t\t\t}\n\t\t} else if (dex.gen === 7 && requirePentagon) {\n\t\t\ttable = table['gen' + dex.gen + 'vgc'];\n\t\t\tisDoublesOrBS = true;\n\t\t} else if (table['gen' + dex.gen + 'doubles'] && dex.gen > 4 && this.formatType !== 'letsgo' && this.formatType !== 'dlc1doubles' &&\n\t\t\t(\n\t\t\tformat.includes('doubles') || format.includes('vgc') || format.includes('triples') ||\n\t\t\tformat.endsWith('lc') || format.endsWith('lcuu')\n\t\t)) {\n\t\t\ttable = table['gen' + dex.gen + 'doubles'];\n\t\t\tisDoublesOrBS = true;\n\t\t} else if (dex.gen < 8 && !this.formatType) {\n\t\t\ttable = table['gen' + dex.gen];\n\t\t} else if (this.formatType === 'letsgo') {\n\t\t\ttable = table['letsgo'];\n\t\t} else if (this.formatType === 'natdex') {\n\t\t\ttable = table['natdex'];\n\t\t} else if (this.formatType === 'metronome') {\n\t\t\ttable = table['metronome'];\n\t\t} else if (this.formatType === 'nfe') {\n\t\t\ttable = table['gen' + dex.gen + 'nfe'];\n\t\t} else if (this.formatType?.startsWith('dlc1')) {\n\t\t\tif (this.formatType.includes('doubles')) {\n\t\t\t\ttable = table['gen8dlc1doubles'];\n\t\t\t} else {\n\t\t\t\ttable = table['gen8dlc1'];\n\t\t\t}\n\t\t}\n\t\tif (!table.tierSet) {\n\t\t\ttable.tierSet = table.tiers.map((r: any) => {\n\t\t\t\tif (typeof r === 'string') return ['pokemon', r];\n\t\t\t\treturn [r[0], r[1]];\n\t\t\t});\n\t\t\ttable.tiers = null;\n\t\t}\n\t\tlet tierSet: SearchRow[] = table.tierSet;\n\t\tlet slices: {[k: string]: number} = table.formatSlices;\n\t\tif (format === 'ubers' || format === 'uber') tierSet = tierSet.slice(slices.Uber);\n\t\telse if (format === 'vgc2017') tierSet = tierSet.slice(slices.Regular);\n\t\telse if (format === 'vgc2018') tierSet = tierSet.slice(slices.Regular);\n\t\telse if (format.startsWith('vgc2019')) tierSet = tierSet.slice(slices[\"Restricted Legendary\"]);\n\t\telse if (format === 'battlespotsingles') tierSet = tierSet.slice(slices.Regular);\n\t\telse if (format === 'battlespotdoubles') tierSet = tierSet.slice(slices.Regular);\n\t\telse if (format === 'ou') tierSet = tierSet.slice(slices.OU);\n\t\telse if (format === 'uu') tierSet = tierSet.slice(slices.UU);\n\t\telse if (format === 'ru') tierSet = tierSet.slice(slices.RU || slices.UU);\n\t\telse if (format === 'nu') tierSet = tierSet.slice(slices.NU || slices.UU);\n\t\telse if (format === 'pu') tierSet = tierSet.slice(slices.PU || slices.NU);\n\t\telse if (format === 'zu') tierSet = tierSet.slice(slices.ZU || slices.PU || slices.NU);\n\t\telse if (format === 'lc' || format === 'lcuu' || format.startsWith('lc') || (format !== 'caplc' && format.endsWith('lc'))) tierSet = tierSet.slice(slices.LC);\n\t\telse if (format === 'cap') tierSet = tierSet.slice(0, slices.Uber).concat(tierSet.slice(slices.OU));\n\t\telse if (format === 'caplc') tierSet = tierSet.slice(slices['CAP LC'], slices.Uber).concat(tierSet.slice(slices.LC));\n\t\telse if (format === 'anythinggoes' || format.endsWith('ag')) tierSet = tierSet.slice(slices.AG);\n\t\telse if (format === 'balancedhackmons' || format.endsWith('bh')) tierSet = tierSet.slice(slices.AG);\n\t\telse if (format === 'doublesubers') tierSet = tierSet.slice(slices.DUber);\n\t\telse if (format === 'doublesou' && dex.gen > 4) tierSet = tierSet.slice(slices.DOU);\n\t\telse if (format === 'doublesuu') tierSet = tierSet.slice(slices.DUU);\n\t\telse if (format === 'doublesnu') tierSet = tierSet.slice(slices.DNU || slices.DUU);\n\t\telse if (this.formatType === 'letsgo') tierSet = tierSet.slice(slices.Uber);\n\t\t// else if (isDoublesOrBS) tierSet = tierSet;\n\t\telse if (!isDoublesOrBS) {\n\t\t\ttierSet = [\n\t\t\t\t...tierSet.slice(slices.OU, slices.UU),\n\t\t\t\t...tierSet.slice(slices.AG, slices.Uber),\n\t\t\t\t...tierSet.slice(slices.Uber, slices.OU),\n\t\t\t\t...tierSet.slice(slices.UU),\n\t\t\t];\n\t\t} else {\n\t\t\ttierSet = [\n\t\t\t\t...tierSet.slice(slices.DOU, slices.DUU),\n\t\t\t\t...tierSet.slice(slices.DUber, slices.DOU),\n\t\t\t\t...tierSet.slice(slices.DUU),\n\t\t\t];\n\t\t}\n\n\t\tif (format === 'zu' && dex.gen >= 7) {\n\t\t\ttierSet = tierSet.filter(([type, id]) => {\n\t\t\t\tif (id in table.zuBans) return false;\n\t\t\t\treturn true;\n\t\t\t});\n\t\t}\n\t\tif (format === 'vgc2016') {\n\t\t\ttierSet = tierSet.filter(([type, id]) => {\n\t\t\t\tlet banned = [\n\t\t\t\t\t'deoxys', 'deoxysattack', 'deoxysdefense', 'deoxysspeed', 'mew', 'celebi', 'shaymin', 'shayminsky', 'darkrai', 'victini', 'keldeo', 'keldeoresolute', 'meloetta', 'arceus', 'genesect', 'jirachi', 'manaphy', 'phione', 'hoopa', 'hoopaunbound', 'diancie', 'dianciemega',\n\t\t\t\t];\n\t\t\t\treturn !(banned.includes(id) || id.startsWith('arceus'));\n\t\t\t});\n\t\t}\n\n\t\tif (this.mod && !table.customTierSet) {\n\t\t\ttable.customTierSet = table.customTiers.map((r: any) => {\n\t\t\t\tif (typeof r === 'string') return ['pokemon', r];\n\t\t\t\treturn [r[0], r[1]];\n\t\t\t});\n\t\t\ttable.customTiers = null;\n\t\t}\n\t\tlet customTierSet: SearchRow[] = table.customTierSet;\n\t\tif (customTierSet) {\n\t\t\ttierSet = customTierSet.concat(tierSet);\n\t\t\tif (modFormatTable.bans.length > 0 && !modFormatTable.bans.includes(\"All Pokemon\")) {\n\t\t\t\ttierSet = tierSet.filter(([type, id]) => {\n\t\t\t\t\tlet banned = modFormatTable.bans;\n\t\t\t\t\treturn !(banned.includes(id));\n\t\t\t\t});\n\t\t\t} else if (modFormatTable.unbans.length > 0 && modFormatTable.bans.includes(\"All Pokemon\")) {\n\t\t\t\ttierSet = tierSet.filter(([type, id]) => {\n\t\t\t\t\tlet unbanned = modFormatTable.unbans;\n\t\t\t\t\treturn (unbanned.includes(id) || type === 'header');\n\t\t\t\t});\n\t\t\t}\n\t\t\tlet headerCount = 0;\n\t\t\tlet lastHeader = '';\n\t\t\tconst emptyHeaders: string[] = [];\n\t\t\tfor (const i in tierSet) {\n\t\t\t\theaderCount = tierSet[i][0] === 'header' ? headerCount + 1 : 0;\n\t\t\t\tif (headerCount > 1) emptyHeaders.push(lastHeader);\n\t\t\t\tif (headerCount > 0) lastHeader = tierSet[i][1];\n\t\t\t}\n\t\t\tif (headerCount === 1) emptyHeaders.push(lastHeader);\n\t\t\ttierSet = tierSet.filter(([type, id]) => {\n\t\t\t\treturn (type !== 'header' || !emptyHeaders.includes(id));\n\t\t\t});\n\t\t}\n\n\t\t// Filter out Gmax Pokemon from standard tier selection\n\t\tif (!/^(battlestadium|vgc|doublesubers)/g.test(format)) {\n\t\t\ttierSet = tierSet.filter(([type, id]) => {\n\t\t\t\tif (type === 'pokemon' && !this.mod) {\n\t\t\t\t\treturn !id.endsWith('gmax');\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t});\n\t\t}\n\n\t\treturn tierSet;\n\t}\n\tfilter(row: SearchRow, filters: string[][]) {\n\t\tif (!filters) return true;\n\t\tif (row[0] !== 'pokemon') return true;\n\t\tconst species = this.dex.getSpecies(row[1]);\n\t\tfor (const [filterType, value] of filters) {\n\t\t\tswitch (filterType) {\n\t\t\tcase 'type':\n\t\t\t\tif (species.types[0] !== value && species.types[1] !== value) return false;\n\t\t\t\tbreak;\n\t\t\tcase 'egggroup':\n\t\t\t\tif (species.eggGroups[0] !== value && species.eggGroups[1] !== value) return false;\n\t\t\t\tbreak;\n\t\t\tcase 'tier':\n\t\t\t\tif (this.getTier(species) !== value) return false;\n\t\t\t\tbreak;\n\t\t\tcase 'ability':\n\t\t\t\tif (!Dex.hasAbility(species, value)) return false;\n\t\t\t\tbreak;\n\t\t\tcase 'move':\n\t\t\t\tif (!this.canLearn(species.id, value as ID)) return false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\tsort(results: SearchRow[], sortCol: string) {\n\t\tconst table = !this.mod ? '' : BattleTeambuilderTable[this.mod].overrideDexInfo;\n\t\tif (['hp', 'atk', 'def', 'spa', 'spd', 'spe'].includes(sortCol)) {\n\t\t\treturn results.sort(([rowType1, id1], [rowType2, id2]) => {\n\t\t\t\tlet pokedex1 = BattlePokedex;\n\t\t\t\tlet pokedex2 = BattlePokedex;\n\t\t\t\tif (this.mod) {\n\t\t\t\t\tif (table[id1] && table[id1].baseStats) pokedex1 = table;\n\t\t\t\t\tif (table[id2] && table[id2].baseStats) pokedex2 = table;\n\t\t\t\t}\n\t\t\t\tconst stat1 = pokedex1[id1].baseStats[sortCol as StatName];\n\t\t\t\tconst stat2 = pokedex2[id2].baseStats[sortCol as StatName];\n\t\t\t\treturn stat2 - stat1;\n\t\t\t});\n\t\t} else if (sortCol === 'bst') {\n\t\t\treturn results.sort(([rowType1, id1], [rowType2, id2]) => {\n\t\t\t\tlet pokedex1 = BattlePokedex;\n\t\t\t\tlet pokedex2 = BattlePokedex;\n\t\t\t\tif (this.mod) {\n\t\t\t\t\tif (table[id1] && table[id1].baseStats) pokedex1 = table;\n\t\t\t\t\tif (table[id2] && table[id2].baseStats) pokedex2 = table;\n\t\t\t\t}\n\t\t\t\tconst base1 = pokedex1[id1].baseStats;\n\t\t\t\tconst base2 = pokedex2[id2].baseStats;\n\t\t\t\tconst bst1 = base1.hp + base1.atk + base1.def + base1.spa + base1.spd + base1.spe;\n\t\t\t\tconst bst2 = base2.hp + base2.atk + base2.def + base2.spa + base2.spd + base2.spe;\n\t\t\t\treturn bst2 - bst1;\n\t\t\t});\n\t\t} else if (sortCol === 'name') {\n\t\t\treturn results.sort(([rowType1, id1], [rowType2, id2]) => {\n\t\t\t\tconst name1 = id1;\n\t\t\t\tconst name2 = id2;\n\t\t\t\treturn name1 < name2 ? -1 : name1 > name2 ? 1 : 0;\n\t\t\t});\n\t\t}\n\t\tthrow new Error(\"invalid sortcol\");\n\t}\n}\n\nclass BattleAbilitySearch extends BattleTypedSearch<'ability'> {\n\tgetTable() {\n\t\tif (!this.mod) return BattleAbilities;\n\t\telse return {...BattleTeambuilderTable[this.mod].fullAbilityName, ...BattleAbilities};\n\t}\n\tgetDefaultResults(): SearchRow[] {\n\t\tconst results: SearchRow[] = [];\n\t\tfor (let id in BattleAbilities) {\n\t\t\tresults.push(['ability', id as ID]);\n\t\t}\n\t\treturn results;\n\t}\n\tgetBaseResults() {\n\t\tif (!this.species) return this.getDefaultResults();\n\t\tconst format = this.format;\n\t\tconst isHackmons = (format.includes('hackmons') || format.endsWith('bh'));\n\t\tconst isAAA = (format === 'almostanyability' || format.includes('aaa'));\n\t\tconst dex = this.dex;\n\t\tlet species = dex.getSpecies(this.species);\n\t\tlet abilitySet: SearchRow[] = [['header', \"Abilities\"]];\n\n\t\tif (species.isMega) {\n\t\t\tabilitySet.unshift(['html', `Will be <strong>${species.abilities['0']}</strong> after Mega Evolving.`]);\n\t\t\tspecies = dex.getSpecies(species.baseSpecies);\n\t\t}\n\t\tabilitySet.push(['ability', toID(species.abilities['0'])]);\n\t\tif (species.abilities['1']) {\n\t\t\tabilitySet.push(['ability', toID(species.abilities['1'])]);\n\t\t}\n\t\tif (species.abilities['H']) {\n\t\t\tabilitySet.push(['header', \"Hidden Ability\"]);\n\t\t\tabilitySet.push(['ability', toID(species.abilities['H'])]);\n\t\t}\n\t\tif (species.abilities['S']) {\n\t\t\tabilitySet.push(['header', \"Special Event Ability\"]);\n\t\t\tabilitySet.push(['ability', toID(species.abilities['S'])]);\n\t\t}\n\t\tif (isAAA || format === 'metronomebattle' || isHackmons) {\n\t\t\tlet abilities: ID[] = [];\n\t\t\tfor (let i in this.getTable()) {\n\t\t\t\tconst ability = dex.getAbility(i);\n\t\t\t\tif (ability.isNonstandard) continue;\n\t\t\t\tif (ability.gen > dex.gen) continue;\n\t\t\t\tabilities.push(ability.id);\n\t\t\t}\n\n\t\t\tlet goodAbilities: SearchRow[] = [['header', \"Abilities\"]];\n\t\t\tlet poorAbilities: SearchRow[] = [['header', \"Situational Abilities\"]];\n\t\t\tlet badAbilities: SearchRow[] = [['header', \"Unviable Abilities\"]];\n\t\t\tfor (const ability of abilities.sort().map(abil => dex.getAbility(abil))) {\n\t\t\t\tlet rating = ability.rating;\n\t\t\t\tif (ability.id === 'normalize') rating = 3;\n\t\t\t\tif (rating >= 3) {\n\t\t\t\t\tgoodAbilities.push(['ability', ability.id]);\n\t\t\t\t} else if (rating >= 2) {\n\t\t\t\t\tpoorAbilities.push(['ability', ability.id]);\n\t\t\t\t} else {\n\t\t\t\t\tbadAbilities.push(['ability', ability.id]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tabilitySet = [...goodAbilities, ...poorAbilities, ...badAbilities];\n\t\t\tif (species.isMega) {\n\t\t\t\tif (isAAA) {\n\t\t\t\t\tabilitySet.unshift(['html', `Will be <strong>${species.abilities['0']}</strong> after Mega Evolving.`]);\n\t\t\t\t}\n\t\t\t\t// species is unused after this, so no need to replace\n\t\t\t}\n\t\t}\n\t\treturn abilitySet;\n\t}\n\tfilter(row: SearchRow, filters: string[][]) {\n\t\tif (!filters) return true;\n\t\tif (row[0] !== 'ability') return true;\n\t\tconst ability = this.dex.getAbility(row[1]);\n\t\tfor (const [filterType, value] of filters) {\n\t\t\tswitch (filterType) {\n\t\t\tcase 'pokemon':\n\t\t\t\tif (!Dex.hasAbility(this.dex.getSpecies(value), ability.name)) return false;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\tsort(results: SearchRow[], sortCol: string | null): SearchRow[] {\n\t\tthrow new Error(\"invalid sortcol\");\n\t}\n}\n\nclass BattleItemSearch extends BattleTypedSearch<'item'> {\n\tgetTable() {\n\t\tif (!this.mod) return BattleItems;\n\t\telse return {...BattleTeambuilderTable[this.mod].fullItemName, ...BattleItems};\n\t}\n\tgetDefaultResults(): SearchRow[] {\n\t\tlet table = BattleTeambuilderTable;\n\t\tif (this.mod) {\n\t\t\ttable = table[this.mod];\n\t\t} else if (this.dex.gen < 8) {\n\t\t\ttable = table['gen' + this.dex.gen];\n\t\t} else if (this.formatType === 'natdex') {\n\t\t\ttable = table['natdex'];\n\t\t} else if (this.formatType === 'metronome') {\n\t\t\ttable = table['metronome'];\n\t\t}\n\t\tif (!table.itemSet) {\n\t\t\ttable.itemSet = table.items.map((r: any) => {\n\t\t\t\tif (typeof r === 'string') {\n\t\t\t\t\treturn ['item', r];\n\t\t\t\t}\n\t\t\t\treturn [r[0], r[1]];\n\t\t\t});\n\t\t\ttable.items = null;\n\t\t}\n\t\treturn table.itemSet;\n\t}\n\tgetBaseResults(): SearchRow[] {\n\t\tif (!this.species) return this.getDefaultResults();\n\t\tconst speciesName = this.dex.getSpecies(this.species).name;\n\t\tconst results = this.getDefaultResults();\n\t\tconst speciesSpecific: SearchRow[] = [];\n\t\tfor (const row of results) {\n\t\t\tif (row[0] !== 'item') continue;\n\t\t\tif (this.dex.getItem(row[1]).itemUser?.includes(speciesName)) {\n\t\t\t\tspeciesSpecific.push(row);\n\t\t\t}\n\t\t}\n\t\tif (speciesSpecific.length) {\n\t\t\treturn [\n\t\t\t\t['header', \"Specific to \" + speciesName],\n\t\t\t\t...speciesSpecific,\n\t\t\t\t...results,\n\t\t\t];\n\t\t}\n\t\treturn results;\n\t}\n\tfilter(row: SearchRow, filters: string[][]) {\n\t\tif (!filters) return true;\n\t\tif (row[0] !== 'ability') return true;\n\t\tconst ability = this.dex.getAbility(row[1]);\n\t\tfor (const [filterType, value] of filters) {\n\t\t\tswitch (filterType) {\n\t\t\tcase 'pokemon':\n\t\t\t\tif (!Dex.hasAbility(this.dex.getSpecies(value), ability.name)) return false;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\tsort(results: SearchRow[], sortCol: string | null): SearchRow[] {\n\t\tthrow new Error(\"invalid sortcol\");\n\t}\n}\n\nclass BattleMoveSearch extends BattleTypedSearch<'move'> {\n\tsortRow: SearchRow = ['sortmove', ''];\n\tgetTable() {\n\t\tif (!this.mod) return BattleMovedex;\n\t\telse return {...BattleTeambuilderTable[this.mod].overrideMoveInfo, ...BattleMovedex};\n\t}\n\tgetDefaultResults(): SearchRow[] {\n\t\tlet results: SearchRow[] = [];\n\t\tresults.push(['header', \"Moves\"]);\n\t\tfor (let id in BattleMovedex) {\n\t\t\tswitch (id) {\n\t\t\tcase 'paleowave':\n\t\t\t\tresults.push(['header', \"CAP moves\"]);\n\t\t\t\tbreak;\n\t\t\tcase 'magikarpsrevenge':\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tresults.push(['move', id as ID]);\n\t\t}\n\t\treturn results;\n\t}\n\tprivate moveIsNotUseless(id: ID, species: Species, abilityid: ID, itemid: ID, moves: string[]) {\n\t\tconst dex = this.dex;\n\t\tif (dex.gen === 1) {\n\t\t\t// Usually not useless for Gen 1\n\t\t\tif ([\n\t\t\t\t'acidarmor', 'amnesia', 'barrier', 'bind', 'blizzard', 'clamp', 'confuseray', 'counter', 'firespin', 'hyperbeam', 'mirrormove', 'pinmissile', 'razorleaf', 'sing', 'slash', 'sludge', 'twineedle', 'wrap',\n\t\t\t].includes(id)) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\t// Usually useless for Gen 1\n\t\t\tif ([\n\t\t\t\t'disable', 'firepunch', 'icepunch', 'leechseed', 'quickattack', 'roar', 'thunderpunch', 'toxic', 'triattack', 'whirlwind',\n\t\t\t].includes(id)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t// Not useless only when certain moves aren't present\n\t\t\tswitch (id) {\n\t\t\tcase 'bubblebeam': return (!moves.includes('surf') && !moves.includes('blizzard'));\n\t\t\tcase 'doubleedge': return !moves.includes('bodyslam');\n\t\t\tcase 'doublekick': return !moves.includes('submission');\n\t\t\tcase 'megadrain': return !moves.includes('razorleaf') && !moves.includes('surf');\n\t\t\tcase 'megakick': return !moves.includes('hyperbeam');\n\t\t\tcase 'reflect': return !moves.includes('barrier') && !moves.includes('acidarmor');\n\t\t\tcase 'submission': return !moves.includes('highjumpkick');\n\t\t\t}\n\t\t}\n\n\t\tif (this.formatType === 'letsgo') {\n\t\t\tif (id === 'megadrain') return true;\n\t\t}\n\n\t\tif (this.formatType === 'metronome') {\n\t\t\tif (id === 'metronome') return true;\n\t\t}\n\n\t\tif (itemid === 'pidgeotite') abilityid = 'noguard' as ID;\n\t\tif (itemid === 'blastoisinite') abilityid = 'megalauncher' as ID;\n\t\tif (itemid === 'aerodactylite') abilityid = 'toughclaws' as ID;\n\t\tif (itemid === 'glalitite') abilityid = 'refrigerate' as ID;\n\n\t\tswitch (id) {\n\t\tcase 'fakeout': case 'flamecharge': case 'nuzzle': case 'poweruppunch':\n\t\t\treturn abilityid !== 'sheerforce';\n\t\tcase 'solarbeam': case 'solarblade':\n\t\t\treturn ['desolateland', 'drought', 'chlorophyll'].includes(abilityid) || itemid === 'powerherb';\n\t\tcase 'dynamicpunch': case 'grasswhistle': case 'inferno': case 'sing': case 'zapcannon':\n\t\t\treturn abilityid === 'noguard';\n\t\tcase 'heatcrash': case 'heavyslam':\n\t\t\treturn species.weightkg >= (species.evos ? 75 : 130);\n\n\t\tcase 'aerialace':\n\t\t\treturn ['technician', 'toughclaws'].includes(abilityid) && !moves.includes('bravebird');\n\t\tcase 'ancientpower':\n\t\t\treturn ['serenegrace', 'technician'].includes(abilityid) || !moves.includes('powergem');\n\t\tcase 'aurawheel':\n\t\t\treturn species.baseSpecies === 'Morpeko';\n\t\tcase 'bellydrum':\n\t\t\treturn moves.includes('aquajet') || moves.includes('extremespeed') ||\n\t\t\t\t['iceface', 'unburden'].includes(abilityid);\n\t\tcase 'bulletseed':\n\t\t\treturn ['skilllink', 'technician'].includes(abilityid);\n\t\tcase 'counter':\n\t\t\treturn species.baseStats.hp >= 65;\n\t\tcase 'darkvoid':\n\t\t\treturn dex.gen < 7;\n\t\tcase 'drainingkiss':\n\t\t\treturn abilityid === 'triage';\n\t\tcase 'dualwingbeat':\n\t\t\treturn abilityid === 'technician' || !moves.includes('drillpeck');\n\t\tcase 'feint':\n\t\t\treturn abilityid === 'refrigerate';\n\t\tcase 'grassyglide':\n\t\t\treturn abilityid === 'grassysurge';\n\t\tcase 'gyroball':\n\t\t\treturn species.baseStats.spe <= 60;\n\t\tcase 'headbutt':\n\t\t\treturn abilityid === 'serenegrace';\n\t\tcase 'hiddenpowerelectric':\n\t\t\treturn (dex.gen < 4 && !moves.includes('thunderpunch')) && !moves.includes('thunderbolt');\n\t\tcase 'hiddenpowerfighting':\n\t\t\treturn (dex.gen < 4 && !moves.includes('brickbreak')) && !moves.includes('aurasphere') && !moves.includes('focusblast');\n\t\tcase 'hiddenpowerfire':\n\t\t\treturn (dex.gen < 4 && !moves.includes('firepunch')) && !moves.includes('flamethrower');\n\t\tcase 'hiddenpowergrass':\n\t\t\treturn !moves.includes('energyball') && !moves.includes('grassknot') && !moves.includes('gigadrain');\n\t\tcase 'hiddenpowerice':\n\t\t\treturn !moves.includes('icebeam') && (dex.gen < 4 && !moves.includes('icepunch')) || (dex.gen > 5 && !moves.includes('aurorabeam'));\n\t\tcase 'hiddenpowerflying':\n\t\t\treturn dex.gen < 4 && !moves.includes('drillpeck');\n\t\tcase 'hiddenpowerbug':\n\t\t\treturn dex.gen < 4 && !moves.includes('megahorn');\n\t\tcase 'hiddenpowerpsychic':\n\t\t\treturn species.baseSpecies === 'Unown';\n\t\tcase 'hyperspacefury':\n\t\t\treturn species.id === 'hoopaunbound';\n\t\tcase 'hypnosis':\n\t\t\treturn (dex.gen < 4 && !moves.includes('sleeppowder')) || (dex.gen > 6 && abilityid === 'baddreams');\n\t\tcase 'icywind':\n\t\t\t// Keldeo needs Hidden Power for Electric/Ghost\n\t\t\treturn species.baseSpecies === 'Keldeo' || this.formatType === 'doubles';\n\t\tcase 'infestation':\n\t\t\treturn moves.includes('stickyweb');\n\t\tcase 'irontail':\n\t\t\treturn dex.gen > 5 && !moves.includes('ironhead') && !moves.includes('gunkshot') && !moves.includes('poisonjab');\n\t\tcase 'jumpkick':\n\t\t\treturn !moves.includes('highjumpkick');\n\t\tcase 'leechlife':\n\t\t\treturn dex.gen > 6;\n\t\tcase 'mysticalfire':\n\t\t\treturn dex.gen > 6 && !moves.includes('flamethrower');\n\t\tcase 'naturepower':\n\t\t\treturn dex.gen === 5;\n\t\tcase 'nightslash':\n\t\t\treturn !moves.includes('crunch') && !(moves.includes('knockoff') && dex.gen >= 6);\n\t\tcase 'petaldance':\n\t\t\treturn abilityid === 'owntempo';\n\t\tcase 'phantomforce':\n\t\t\treturn (!moves.includes('poltergeist') && !moves.includes('shadowclaw')) || this.formatType === 'doubles';\n\t\tcase 'poisonfang':\n\t\t\treturn species.types.includes('Poison') && !moves.includes('gunkshot') && !moves.includes('poisonjab');\n\t\tcase 'relicsong':\n\t\t\treturn species.id === 'meloetta';\n\t\tcase 'refresh':\n\t\t\treturn !moves.includes('aromatherapy') && !moves.includes('healbell');\n\t\tcase 'risingvoltage':\n\t\t\treturn abilityid === 'electricsurge';\n\t\tcase 'rocktomb':\n\t\t\treturn abilityid === 'technician';\n\t\tcase 'selfdestruct':\n\t\t\treturn dex.gen < 5 && !moves.includes('explosion');\n\t\tcase 'shadowpunch':\n\t\t\treturn abilityid === 'ironfist';\n\t\tcase 'smackdown':\n\t\t\treturn species.types.includes('Ground');\n\t\tcase 'smartstrike':\n\t\t\treturn species.types.includes('Steel') && !moves.includes('ironhead');\n\t\tcase 'soak':\n\t\t\treturn abilityid === 'unaware';\n\t\tcase 'steelwing':\n\t\t\treturn !moves.includes('ironhead');\n\t\tcase 'stompingtantrum':\n\t\t\treturn (!moves.includes('earthquake') && !moves.includes('drillrun')) || this.formatType === 'doubles';\n\t\tcase 'stunspore':\n\t\t\treturn !moves.includes('thunderwave');\n\t\tcase 'technoblast':\n\t\t\treturn dex.gen > 5 && itemid.endsWith('drive') || itemid === 'dousedrive';\n\t\tcase 'teleport':\n\t\t\treturn dex.gen > 7;\n\t\tcase 'terrainpulse': case 'waterpulse':\n\t\t\treturn ['megalauncher', 'technician'].includes(abilityid) && !moves.includes('originpulse');\n\t\tcase 'trickroom':\n\t\t\treturn species.baseStats.spe <= 100;\n\t\t}\n\n\t\tif (this.formatType === 'doubles' && BattleMoveSearch.GOOD_DOUBLES_MOVES.includes(id)) {\n\t\t\treturn true;\n\t\t}\n\t\t// Custom move added by a mod\n\t\tif (this.mod && id in BattleTeambuilderTable[this.mod].overrideMoveInfo) return true;\n\t\tconst moveData = BattleMovedex[id];\n\t\tif (!moveData) return true;\n\t\tif (moveData.category === 'Status') {\n\t\t\treturn BattleMoveSearch.GOOD_STATUS_MOVES.includes(id);\n\t\t}\n\t\tif (moveData.basePower < 75) {\n\t\t\treturn BattleMoveSearch.GOOD_WEAK_MOVES.includes(id);\n\t\t}\n\t\tif (id === 'skydrop') return true;\n\t\t// strong moves\n\t\tif (moveData.flags?.charge) {\n\t\t\treturn itemid === 'powerherb';\n\t\t}\n\t\tif (moveData.flags?.recharge) {\n\t\t\treturn false;\n\t\t}\n\t\treturn !BattleMoveSearch.BAD_STRONG_MOVES.includes(id);\n\t}\n\tstatic readonly GOOD_STATUS_MOVES = [\n\t\t'agility', 'aromatherapy', 'auroraveil', 'autotomize', 'banefulbunker', 'batonpass', 'bellydrum', 'bulkup', 'calmmind', 'clangoroussoul', 'coil', 'cottonguard', 'courtchange', 'curse', 'defog', 'destinybond', 'detect', 'disable', 'dragondance', 'drainingkiss', 'encore', 'extremeevoboost', 'geomancy', 'glare', 'haze', 'healbell', 'healingwish', 'healorder', 'heartswap', 'honeclaws', 'kingsshield', 'irondefense', 'leechseed', 'lightscreen', 'lovelykiss', 'lunardance', 'magiccoat', 'maxguard', 'memento', 'milkdrink', 'moonlight', 'morningsun', 'nastyplot', 'naturesmadness', 'noretreat', 'obstruct', 'painsplit', 'partingshot', 'perishsong', 'protect', 'quiverdance', 'recover', 'reflect', 'reflecttype', 'rest', 'roar', 'rockpolish', 'roost', 'shellsmash', 'shiftgear', 'slackoff', 'sleeppowder', 'sleeptalk', 'softboiled', 'spikes', 'spikyshield', 'spore', 'stealthrock', 'stickyweb', 'strengthsap', 'substitute', 'switcheroo', 'swordsdance', 'synthesis', 'tailglow', 'tailwind', 'taunt', 'thunderwave', 'toxic', 'toxicspikes', 'transform', 'trick', 'whirlwind', 'willowisp', 'wish', 'yawn',\n\t] as ID[] as readonly ID[];\n\tstatic readonly GOOD_WEAK_MOVES = [\n\t\t'accelerock', 'acrobatics', 'aquajet', 'avalanche', 'bonemerang', 'bouncybubble', 'bulletpunch', 'buzzybuzz', 'circlethrow', 'clearsmog', 'doubleironbash', 'dragondarts', 'dragontail', 'endeavor', 'facade', 'firefang', 'flipturn', 'freezedry', 'frustration', 'geargrind', 'grassknot', 'gyroball', 'hex', 'icefang', 'iceshard', 'iciclespear', 'knockoff', 'lowkick', 'machpunch', 'nightshade', 'nuzzle', 'pikapapow', 'psychocut', 'pursuit', 'quickattack', 'rapidspin', 'return', 'rockblast', 'scorchingsands', 'seismictoss', 'shadowclaw', 'shadowsneak', 'sizzlyslide', 'storedpower', 'stormthrow', 'suckerpunch', 'superfang', 'surgingstrikes', 'tailslap', 'tripleaxel', 'uturn', 'veeveevolley', 'voltswitch', 'watershuriken', 'weatherball',\n\t] as ID[] as readonly ID[];\n\tstatic readonly BAD_STRONG_MOVES = [\n\t\t'beakblast', 'belch', 'burnup', 'crushclaw', 'doomdesire', 'dragonrush', 'dreameater', 'eggbomb', 'firepledge', 'flyingpress', 'futuresight', 'grasspledge', 'hyperbeam', 'hyperfang', 'hyperspacehole', 'jawlock', 'landswrath', 'lastresort', 'megakick', 'megapunch', 'mistyexplosion', 'muddywater', 'nightdaze', 'pollenpuff', 'rockclimb', 'selfdestruct', 'shelltrap', 'skyuppercut', 'slam', 'strength', 'submission', 'synchronoise', 'takedown', 'thrash', 'uproar', 'waterpledge',\n\t] as ID[] as readonly ID[];\n\tstatic readonly GOOD_DOUBLES_MOVES = [\n\t\t'allyswitch', 'bulldoze', 'coaching', 'electroweb', 'faketears', 'fling', 'followme', 'healpulse', 'helpinghand', 'junglehealing', 'lifedew', 'muddywater', 'pollenpuff', 'psychup', 'ragepowder', 'safeguard', 'skillswap', 'snipeshot', 'wideguard',\n\t] as ID[] as readonly ID[];\n\tgetBaseResults() {\n\t\tif (!this.species) return this.getDefaultResults();\n\t\tconst dex = this.dex;\n\t\tlet species = dex.getSpecies(this.species);\n\t\tconst format = this.format;\n\t\tconst isHackmons = (format.includes('hackmons') || format.endsWith('bh'));\n\t\tconst isSTABmons = (format.includes('stabmons') || format === 'staaabmons');\n\t\tconst galarBornLegality = (format.includes('battlestadium') || format.startsWith('vgc') && this.dex.gen === 8);\n\n\t\tconst abilityid = this.set ? toID(this.set.ability) : '' as ID;\n\t\tconst itemid = this.set ? toID(this.set.item) : '' as ID;\n\n\t\tlet learnsetid = this.firstLearnsetid(species.id);\n\t\tlet moves: string[] = [];\n\t\tlet sketchMoves: string[] = [];\n\t\tlet sketch = false;\n\t\tlet gen = '' + dex.gen;\n\t\twhile (learnsetid) {\n\t\t\tlet learnset = BattleTeambuilderTable.learnsets[learnsetid];\n\t\t\tif (this.mod) {\n\t\t\t\tlearnset = JSON.parse(JSON.stringify(learnset));\n\t\t\t\tconst overrideLearnsets = BattleTeambuilderTable[this.mod].overrideLearnsets;\n\t\t\t\tif (overrideLearnsets[learnsetid]) {\n\t\t\t\t\tfor (const moveid in overrideLearnsets[learnsetid]) learnset[moveid] = overrideLearnsets[learnsetid][moveid];\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.formatType === 'letsgo') learnset = BattleTeambuilderTable['letsgo'].learnsets[learnsetid];\n\t\t\tif (this.formatType?.startsWith('dlc1')) learnset = BattleTeambuilderTable['gen8dlc1'].learnsets[learnsetid];\n\t\t\tif (learnset) {\n\t\t\t\tfor (let moveid in learnset) {\n\t\t\t\t\tlet learnsetEntry = learnset[moveid];\n\t\t\t\t\t/* if (requirePentagon && learnsetEntry.indexOf('p') < 0) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} */\n\t\t\t\t\tif (galarBornLegality && !learnsetEntry.includes('g')) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else if (!learnsetEntry.includes(gen)) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tif (this.dex.gen >= 8 && this.dex.getMove(moveid) && this.dex.getMove(moveid).isNonstandard === 'Past' && this.formatType !== 'natdex') continue;\n\t\t\t\t\tif (this.formatType?.startsWith('dlc1') && BattleTeambuilderTable['gen8dlc1']?.nonstandardMoves.includes(moveid)) continue;\n\t\t\t\t\tif (moves.includes(moveid)) continue;\n\t\t\t\t\tmoves.push(moveid);\n\t\t\t\t\tif (moveid === 'sketch') sketch = true;\n\t\t\t\t\tif (moveid === 'hiddenpower') {\n\t\t\t\t\t\tmoves.push(\n\t\t\t\t\t\t\t'hiddenpowerbug', 'hiddenpowerdark', 'hiddenpowerdragon', 'hiddenpowerelectric', 'hiddenpowerfighting', 'hiddenpowerfire', 'hiddenpowerflying', 'hiddenpowerghost', 'hiddenpowergrass', 'hiddenpowerground', 'hiddenpowerice', 'hiddenpowerpoison', 'hiddenpowerpsychic', 'hiddenpowerrock', 'hiddenpowersteel', 'hiddenpowerwater'\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tlearnsetid = this.nextLearnsetid(learnsetid, species.id);\n\t\t}\n\t\tif (sketch || isHackmons) {\n\t\t\tif (isHackmons) moves = [];\n\t\t\tfor (let id in BattleMovedex) {\n\t\t\t\tif (!format.startsWith('cap') && (id === 'paleowave' || id === 'shadowstrike')) continue;\n\t\t\t\tconst move = dex.getMove(id);\n\t\t\t\tif (move.gen > dex.gen) continue;\n\t\t\t\tif (sketch) {\n\t\t\t\t\tif (move.isMax || move.isZ || move.isNonstandard) continue;\n\t\t\t\t\tsketchMoves.push(move.id);\n\t\t\t\t} else {\n\t\t\t\t\tif (!(dex.gen < 8 || this.formatType === 'natdex') && move.isZ) continue;\n\t\t\t\t\tif (typeof move.isMax === 'string') continue;\n\t\t\t\t\tif (move.isNonstandard === 'Past' && this.formatType !== 'natdex' && dex.gen === 8) continue;\n\t\t\t\t\tmoves.push(move.id);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (this.formatType === 'metronome') moves = ['metronome'];\n\t\tif (isSTABmons) {\n\t\t\tfor (let id in BattleMovedex) {\n\t\t\t\tlet types: string[] = [];\n\t\t\t\tlet baseSpecies = dex.getSpecies(species.changesFrom || species.name);\n\t\t\t\tif (!species.battleOnly) types.push(...species.types);\n\t\t\t\tlet prevo = species.prevo;\n\t\t\t\twhile (prevo) {\n\t\t\t\t\tconst prevoSpecies = dex.getSpecies(prevo);\n\t\t\t\t\ttypes.push(...prevoSpecies.types);\n\t\t\t\t\tprevo = prevoSpecies.prevo;\n\t\t\t\t}\n\t\t\t\tif (species.battleOnly) species = baseSpecies;\n\t\t\t\tconst excludedForme = (s: Species) => ['Alola', 'Alola-Totem', 'Galar', 'Galar-Zen'].includes(s.forme);\n\t\t\t\tif (baseSpecies.otherFormes && !['Wormadam', 'Urshifu'].includes(baseSpecies.baseSpecies)) {\n\t\t\t\t\tif (!excludedForme(species)) types.push(...baseSpecies.types);\n\t\t\t\t\tfor (const formeName of baseSpecies.otherFormes) {\n\t\t\t\t\t\tconst forme = dex.getSpecies(formeName);\n\t\t\t\t\t\tif (!forme.battleOnly && !excludedForme(forme)) types.push(...forme.types);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tconst move = Dex.getMove(id);\n\t\t\t\tif (!types.includes(move.type)) continue;\n\t\t\t\tif (moves.includes(move.id)) continue;\n\t\t\t\tif (move.gen > dex.gen) continue;\n\t\t\t\tif (move.isZ || move.isMax || move.isNonstandard) continue;\n\t\t\t\tmoves.push(id);\n\t\t\t}\n\t\t}\n\n\t\tmoves.sort();\n\t\tsketchMoves.sort();\n\n\t\tlet usableMoves: SearchRow[] = [];\n\t\tlet uselessMoves: SearchRow[] = [];\n\t\tfor (const id of moves) {\n\t\t\tconst isUsable = this.moveIsNotUseless(id as ID, species, abilityid, itemid, moves);\n\t\t\tif (isUsable) {\n\t\t\t\tif (!usableMoves.length) usableMoves.push(['header', \"Moves\"]);\n\t\t\t\tusableMoves.push(['move', id as ID]);\n\t\t\t} else {\n\t\t\t\tif (!uselessMoves.length) uselessMoves.push(['header', \"Usually useless moves\"]);\n\t\t\t\tuselessMoves.push(['move', id as ID]);\n\t\t\t}\n\t\t}\n\t\tif (sketchMoves.length) {\n\t\t\tusableMoves.push(['header', \"Sketched moves\"]);\n\t\t\tuselessMoves.push(['header', \"Useless sketched moves\"]);\n\t\t}\n\t\tfor (const id of sketchMoves) {\n\t\t\tconst isUsable = this.moveIsNotUseless(id as ID, species, abilityid, itemid, sketchMoves);\n\t\t\tif (isUsable) {\n\t\t\t\tusableMoves.push(['move', id as ID]);\n\t\t\t} else {\n\t\t\t\tuselessMoves.push(['move', id as ID]);\n\t\t\t}\n\t\t}\n\t\treturn [...usableMoves, ...uselessMoves];\n\t}\n\tfilter(row: SearchRow, filters: string[][]) {\n\t\tif (!filters) return true;\n\t\tif (row[0] !== 'move') return true;\n\t\tconst move = this.dex.getMove(row[1]);\n\t\tfor (const [filterType, value] of filters) {\n\t\t\tswitch (filterType) {\n\t\t\tcase 'type':\n\t\t\t\tif (move.type !== value) return false;\n\t\t\t\tbreak;\n\t\t\tcase 'category':\n\t\t\t\tif (move.category !== value) return false;\n\t\t\t\tbreak;\n\t\t\tcase 'pokemon':\n\t\t\t\tif (!this.canLearn(value as ID, move.id)) return false;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\tsort(results: SearchRow[], sortCol: string): SearchRow[] {\n\t\tswitch (sortCol) {\n\t\tcase 'power':\n\t\t\tlet powerTable: {[id: string]: number | undefined} = {\n\t\t\t\treturn: 102, frustration: 102, spitup: 300, trumpcard: 200, naturalgift: 80, grassknot: 120,\n\t\t\t\tlowkick: 120, gyroball: 150, electroball: 150, flail: 200, reversal: 200, present: 120,\n\t\t\t\twringout: 120, crushgrip: 120, heatcrash: 120, heavyslam: 120, fling: 130, magnitude: 150,\n\t\t\t\tbeatup: 24, punishment: 1020, psywave: 1250, nightshade: 1200, seismictoss: 1200,\n\t\t\t\tdragonrage: 1140, sonicboom: 1120, superfang: 1350, endeavor: 1399, sheercold: 1501,\n\t\t\t\tfissure: 1500, horndrill: 1500, guillotine: 1500,\n\t\t\t};\n\t\t\treturn results.sort(([rowType1, id1], [rowType2, id2]) => {\n\t\t\t\tlet move1 = BattleMovedex[id1];\n\t\t\t\tlet move2 = BattleMovedex[id2];\n\t\t\t\tlet pow1 = move1.basePower;\n\t\t\t\tlet pow2 = move2.basePower;\n\t\t\t\tpow1 = pow1 || powerTable[id1] || (move1.category === 'Status' ? -1 : 1400);\n\t\t\t\tif (BattleTeambuilderTable[this.mod].overrideMoveInfo[id1]) pow1 = BattleTeambuilderTable[this.mod].overrideMoveInfo[id1].basePower;\n\t\t\t\tpow2 = pow2 || powerTable[id2] || (move2.category === 'Status' ? -1 : 1400);\n\t\t\t\tif (BattleTeambuilderTable[this.mod].overrideMoveInfo[id2]) pow2 = BattleTeambuilderTable[this.mod].overrideMoveInfo[id2].basePower;\n\t\t\t\treturn pow2 - pow1;\n\t\t\t});\n\t\tcase 'accuracy':\n\t\t\treturn results.sort(([rowType1, id1], [rowType2, id2]) => {\n\t\t\t\tconst modAcc1 = this.mod ? BattleTeambuilderTable[this.mod].overrideAcc[id1] : null;\n\t\t\t\tconst modAcc2 = this.mod ? BattleTeambuilderTable[this.mod].overrideAcc[id2] : null;\n\t\t\t\tlet accuracy1 = modAcc1 || BattleMovedex[id1].accuracy || 0;\n\t\t\t\tlet accuracy2 = modAcc2 || BattleMovedex[id2].accuracy || 0;\n\t\t\t\tif (accuracy1 === true) accuracy1 = 101;\n\t\t\t\tif (accuracy2 === true) accuracy2 = 101;\n\t\t\t\treturn accuracy2 - accuracy1;\n\t\t\t});\n\t\tcase 'pp':\n\t\t\treturn results.sort(([rowType1, id1], [rowType2, id2]) => {\n\t\t\t\tconst modPP1 = this.mod ? BattleTeambuilderTable[this.mod].overridePP[id1] : null;\n\t\t\t\tconst modPP2 = this.mod ? BattleTeambuilderTable[this.mod].overridePP[id2] : null;\n\t\t\t\tlet pp1 = modPP1 || BattleMovedex[id1].pp || 0;\n\t\t\t\tlet pp2 = modPP2 || BattleMovedex[id2].pp || 0;\n\t\t\t\treturn pp2 - pp1;\n\t\t\t});\n\t\tcase 'name':\n\t\t\treturn results.sort(([rowType1, id1], [rowType2, id2]) => {\n\t\t\t\tconst name1 = id1;\n\t\t\t\tconst name2 = id2;\n\t\t\t\treturn name1 < name2 ? -1 : name1 > name2 ? 1 : 0;\n\t\t\t});\n\t\t}\n\t\tthrow new Error(\"invalid sortcol\");\n\t}\n}\n\nclass BattleCategorySearch extends BattleTypedSearch<'category'> {\n\tgetTable() {\n\t\treturn {physical: 1, special: 1, status: 1};\n\t}\n\tgetDefaultResults(): SearchRow[] {\n\t\treturn [\n\t\t\t['category', 'physical' as ID],\n\t\t\t['category', 'special' as ID],\n\t\t\t['category', 'status' as ID],\n\t\t];\n\t}\n\tgetBaseResults() {\n\t\treturn this.getDefaultResults();\n\t}\n\tfilter(row: SearchRow, filters: string[][]): boolean {\n\t\tthrow new Error(\"invalid filter\");\n\t}\n\tsort(results: SearchRow[], sortCol: string | null): SearchRow[] {\n\t\tthrow new Error(\"invalid sortcol\");\n\t}\n}\n\nclass BattleTypeSearch extends BattleTypedSearch<'type'> {\n\tgetTable() {\n\t\tif (!this.mod) return window.BattleTypeChart;\n\t\telse return {...BattleTeambuilderTable[this.mod].overrideTypeChart, ...window.BattleTypeChart};\n\t}\n\tgetDefaultResults(): SearchRow[] {\n\t\tconst results: SearchRow[] = [];\n\t\tfor (let id in window.BattleTypeChart) {\n\t\t\tresults.push(['type', id as ID]);\n\t\t}\n\t\treturn results;\n\t}\n\tgetBaseResults() {\n\t\treturn this.getDefaultResults();\n\t}\n\tfilter(row: SearchRow, filters: string[][]): boolean {\n\t\tthrow new Error(\"invalid filter\");\n\t}\n\tsort(results: SearchRow[], sortCol: string | null): SearchRow[] {\n\t\tthrow new Error(\"invalid sortcol\");\n\t}\n}\n"],"file":"battle-dex-search.js"}